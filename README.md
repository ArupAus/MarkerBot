# MarkerBot
Automates python assignment marking for https://github.com/tomvalorsa/python-course


# Developer Installation Instructions

Install virtualenv package

```
pip install virtualenv
```

Create directory for virtual environment where you have cloned MarkerBot to
by cd to that directory

```
virtualenv venv
```

## To run the virtual environment
In the same directory run
### On Windows
```
"venv/Scripts/activate.bat"
```
### On Mac
```
source venv/bin/activate
```

### Now Install your dependencies inside  your virtual environment
#### Make sure that you are in the virtual environment at this point. You should see a (venv) at the beginning of your console line. (or underneath if using git bash on windows)

```
pip install -r requirements.txt --trusted-host pypi.python.org
```


# Database Setup
Install [postgresql 9.6](https://www.postgresql.org/download/) if you don't already have it

Then create a DB for development/testing
```
$ psql -U postgres template1
# create database MarkerBot;
CREATE DATABASE
# \q
```
or use pgAdmin4 to create db via interface
you can switch which DB you interact with by changing between `APP_SETTINGS="config.DevelopmentConfig"` in your .env
you can configure the configs in config.py

To initialise DB run

`python manage.py db init`

and then use the following commands should you want to make changes to models.py and have them reflected in the DB

`python manage.py db migrate`
 then go the newly created file in  migrations/versions/autogeneratedmigration.py.
 Anywhere you see `astext_type=Text())` change it to `astext_type=sa.Text())`
 (dont know why alembic doesn't do this for you...)

and then you can run..
`python manage.py db upgrade`
you should now have a DB with the latest schema

# Starting celery task queue
```
python -m celery -A tasks.celery worker --loglevel=info
```